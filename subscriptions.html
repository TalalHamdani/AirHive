<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trending - AirHive</title>
    
    <!-- Clerk SDK -->
    <script
    async
    crossorigin="anonymous"
    data-clerk-publishable-key="pk_test_dG9waWNhbC1wdWctNjYuY2xlcmsuYWNjb3VudHMuZGV2JA"
    src="https://topical-pug-66.clerk.accounts.dev/npm/@clerk/clerk-js@5/dist/clerk.browser.js"
    type="text/javascript">
    </script>
    <script>
        window.onload = async () => {
            await Clerk.load();
            console.log("Preloading Clerk state");
        };
    </script>
    
    <!-- Link to CSS Files -->
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="elements/navbar.css">  <!-- Navbar Styles -->
    <link rel="stylesheet" href="elements/sidebar.css">  <!-- Sidebar Styles -->
    <link rel="stylesheet" href="elements/video-card.css"> <!-- Video Card Styles -->
    <link rel="stylesheet" href="css/default-page.css"> <!-- Default Styles -->

  <!-- Link to JS Files -->
  <script src="elements/navbar.js" defer></script>
  <script src="elements/sidebar.js" defer></script>
  <script src="elements/video-card.js" defer></script>
  
    <!-- Font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');
    </style>

    <script src="https://kit.fontawesome.com/27c8061413.js" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Placeholder for Navbar -->
    <div id="navbar"></div>

    <!-- Placeholder for Sidebar -->
    <div id="sidebar"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Content for logged-in users -->
        <div id="logged-in-content" style="display: none;">
            <h2>Your Subscriptions</h2>
            <div class="videos" id="video-container"></div>

        <!-- Content for logged-out users -->
        <div id="default-content" style="display: none;">
            <h2 class="message-title">Please sign in to view your subscriptions</h2>
            <a href="/signin.html">
                <button id="sign-in-page2">Sign In</button>
            </a>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log("Initializing Clerk...");
                await Clerk.load();

                const loggedInContent = document.getElementById('logged-in-content');
                const defaultContent = document.getElementById('default-content');

                if (Clerk.user) {
                    console.log("User is logged in:", Clerk.user);
                    loggedInContent.style.display = 'block';
                    defaultContent.style.display = 'none';
                } else {
                    console.log("User is not logged in");
                    loggedInContent.style.display = 'none';
                    defaultContent.style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading Clerk or determining user state:', error);

                // Display a fallback error message
                const mainContent = document.querySelector('.main-content');
                mainContent.innerHTML = `
                    <h2 class="error-message">Something went wrong. Please refresh the page.</h2>
                `;
            }
        });
    </script>
</body>
</html>